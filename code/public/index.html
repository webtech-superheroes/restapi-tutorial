<!DOCTYPE html>
<html>
    <head>
        <title>Message list</title>
    </head>
    <body>
        <h1>Messages</h1>

        <!-- initial table structure
        <table style="width:500px;">
                <tr>
                    <th>ID</th>
                    <th>Subject</th>
                    <th>Name</th> 
                    <th>Message</th>
                    <th>Actions</th>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Subject data</td>
                    <td>Name data</td>
                    <td>Message data</td>
                    <td>
                        <button>Edit</button>
                        <button>Delete</button>
                    </td>
                </tr>
        </table>
        -->

        <div id="table"></div>

        <form>
            <input type="hidden" name="id" id="id" /><br />
            Name:<br />
            <input type="text" name="name" id="name" /><br />
            Subject:<br />
            <input type="text" name="subject" id="subject"><br/>
            Message:<br />
            <textarea name="message" id="message"></textarea> <br/>
            <button>Send message</button>
            <button>Cancel</button>
        </form>

        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

        <script 
            src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
        
        <script type="text/javascript">
            function showMessageList() {
                axios.get('/messages').then(function(results) {
                    
                    let html = ` <table style="width:500px;">
                            <tr>
                                <th>ID</th>
                                <th>Subject</th>
                                <th>Name</th> 
                                <th>Message</th>
                                <th>Actions</th>
                            </tr>`
                    
                    results.data.forEach(function(element) {
                        html += `<tr>
                                    <td>${element.id}</td>
                                    <td>${element.name}</td>
                                    <td>${element.subject}</td>
                                    <td>${element.message}</td>
                                    <td>
                                        <button onClick="editMessage(${element.id})">Edit</button>
                                        <button onClick="deleteMessage(${element.id})">Delete</button>
                                    </td>
                                </tr>`
                    })

                    html += `</table>`
                    
                    $('#table').html(html)
                }).catch(function(error) {
                    console.log(error)
                })
            }

            $(document).ready(function() {
                console.log('Hello from JQuery')
                showMessageList()
            })
        </script>    
    </body>
</html>